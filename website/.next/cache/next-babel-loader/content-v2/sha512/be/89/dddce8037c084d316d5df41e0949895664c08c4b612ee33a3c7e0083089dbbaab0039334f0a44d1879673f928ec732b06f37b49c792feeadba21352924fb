{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/sunfei/Downloads/website/src/components/omni-search.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { SearchIcon } from \"@chakra-ui/icons\";\nimport { Box, Center, chakra, Flex, Modal, ModalBody, ModalContent, ModalOverlay, useColorModeValue, useDisclosure, useEventListener, useUpdateEffect } from \"@chakra-ui/react\";\nimport searchData from \"configs/search-meta.json\";\nimport { matchSorter } from \"match-sorter\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport * as React from \"react\";\nimport MultiRef from \"react-multi-ref\";\nimport scrollIntoView from \"scroll-into-view-if-needed\";\nimport { findAll } from \"highlight-words-core\";\nimport { SearchButton } from \"./algolia-search\";\n\nfunction OptionText(props) {\n  const {\n    searchWords,\n    textToHighlight\n  } = props;\n  const chunks = findAll({\n    searchWords,\n    textToHighlight\n  });\n  const highlightedText = chunks.map(chunk => {\n    const {\n      end,\n      highlight,\n      start\n    } = chunk;\n    const text = textToHighlight.substr(start, end - start);\n\n    if (highlight) {\n      return /*#__PURE__*/_jsxDEV(Box, {\n        as: \"mark\",\n        color: \"teal.500\",\n        bg: \"transparent\",\n        fontWeight: \"medium\",\n        children: text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this);\n    } else {\n      return text;\n    }\n  });\n  return highlightedText;\n}\n\nfunction DocIcon(props) {\n  return /*#__PURE__*/_jsxDEV(chakra.svg, _objectSpread(_objectSpread({\n    strokeWidth: \"2px\",\n    width: \"20px\",\n    height: \"20px\",\n    viewBox: \"0 0 20 20\"\n  }, props), {}, {\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      d: \"M17 6v12c0 .52-.2 1-1 1H4c-.7 0-1-.33-1-1V2c0-.55.42-1 1-1h8l5 5zM14 8h-3.13c-.51 0-.87-.34-.87-.87V4\",\n      stroke: \"currentColor\",\n      fill: \"none\",\n      fillRule: \"evenodd\",\n      strokeLinejoin: \"round\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n\nfunction EnterIcon(props) {\n  return /*#__PURE__*/_jsxDEV(chakra.svg, _objectSpread(_objectSpread({\n    strokeWidth: \"2px\",\n    width: \"16px\",\n    height: \"16px\",\n    viewBox: \"0 0 20 20\"\n  }, props), {}, {\n    children: /*#__PURE__*/_jsxDEV(\"g\", {\n      stroke: \"currentColor\",\n      fill: \"none\",\n      fillRule: \"evenodd\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      children: [/*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M18 3v4c0 2-2 4-4 4H2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M8 17l-6-6 6-6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n\nfunction HashIcon(props) {\n  return /*#__PURE__*/_jsxDEV(chakra.svg, _objectSpread(_objectSpread({\n    strokeWidth: \"2px\",\n    width: \"20px\",\n    height: \"20px\",\n    viewBox: \"0 0 20 20\"\n  }, props), {}, {\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      d: \"M13 13h4-4V8H7v5h6v4-4H7V8H3h4V3v5h6V3v5h4-4v5zm-6 0v4-4H3h4z\",\n      stroke: \"currentColor\",\n      fill: \"none\",\n      fillRule: \"evenodd\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n\nfunction OmniSearch() {\n  const router = useRouter();\n  const [query, setQuery] = React.useState(\"\");\n  const [active, setActive] = React.useState(0);\n  const menu = useDisclosure();\n  const modal = useDisclosure();\n  const [menuNodes] = React.useState(() => new MultiRef());\n  const menuRef = React.useRef(null);\n  const eventRef = React.useRef(null);\n  React.useEffect(() => {\n    router.events.on(\"routeChangeComplete\", modal.onClose);\n    return () => {\n      router.events.off(\"routeChangeComplete\", modal.onClose);\n    };\n  }, []);\n  useEventListener(\"keydown\", event => {\n    var _navigator, _event$key;\n\n    const isMac = /(Mac|iPhone|iPod|iPad)/i.test((_navigator = navigator) === null || _navigator === void 0 ? void 0 : _navigator.platform);\n    const hotkey = isMac ? \"metaKey\" : \"ctrlKey\";\n\n    if ((event === null || event === void 0 ? void 0 : (_event$key = event.key) === null || _event$key === void 0 ? void 0 : _event$key.toLowerCase()) === \"k\" && event[hotkey]) {\n      event.preventDefault();\n      modal.onOpen();\n    }\n  });\n  React.useEffect(() => {\n    if (modal.isOpen && query.length > 0) {\n      setQuery(\"\");\n    }\n  }, [modal.isOpen]);\n  const results = React.useMemo(function getResults() {\n    if (query.length < 2) return [];\n    return matchSorter(searchData, query, {\n      keys: [\"content\", \"hierarchy.lvl1\", \"hierarchy.lvl2\", \"hierarchy.lvl3\"]\n    }).slice(0, 20).sort((a, b) => {\n      if (a.hierarchy.lvl2 == null && b.hierarchy != null) return -1;\n      if (a.hierarchy.lvl2 != null && b.hierarchy == null) return 1;\n      return 0;\n    });\n  }, [query]);\n  const onKeyDown = React.useCallback(e => {\n    eventRef.current = \"keyboard\";\n\n    switch (e.key) {\n      case \"ArrowDown\":\n        {\n          e.preventDefault();\n\n          if (active + 1 < results.length) {\n            setActive(active + 1);\n          }\n\n          break;\n        }\n\n      case \"ArrowUp\":\n        {\n          e.preventDefault();\n\n          if (active - 1 >= 0) {\n            setActive(active - 1);\n          }\n\n          break;\n        }\n\n      case \"Enter\":\n        {\n          router.push(results[active].url);\n          break;\n        }\n    }\n  }, [active, results, router]);\n  useUpdateEffect(() => {\n    setActive(0);\n  }, [query]);\n  useUpdateEffect(() => {\n    if (!menuRef.current || eventRef.current === \"mouse\") return;\n    const node = menuNodes.map.get(active);\n    if (!node) return;\n    scrollIntoView(node, {\n      scrollMode: \"if-needed\",\n      block: \"nearest\",\n      inline: \"nearest\",\n      boundary: menuRef.current\n    });\n  }, [active]);\n  const open = menu.isOpen && results.length > 0;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SearchButton, {\n      onClick: modal.onOpen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      scrollBehavior: \"inside\",\n      isOpen: modal.isOpen,\n      onClose: modal.onClose,\n      children: [/*#__PURE__*/_jsxDEV(ModalOverlay, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalContent, {\n        role: \"combobox\",\n        \"aria-expanded\": \"true\",\n        \"aria-haspopup\": \"listbox\",\n        rounded: \"md\",\n        overflow: \"hidden\",\n        top: \"10vh\",\n        bg: \"transparent\",\n        shadow: \"search\",\n        children: [/*#__PURE__*/_jsxDEV(Flex, {\n          pos: \"relative\",\n          align: \"stretch\",\n          children: [/*#__PURE__*/_jsxDEV(chakra.input, {\n            \"aria-autocomplete\": \"list\",\n            autoComplete: \"off\",\n            autoCorrect: \"off\",\n            spellCheck: \"false\",\n            maxLength: 64,\n            w: \"100%\",\n            h: \"40px\",\n            bg: useColorModeValue(\"white\", \"gray.700\"),\n            pl: \"40px\",\n            outline: \"0\",\n            id: \"docsearch-input\",\n            placeholder: \"Search the docs\",\n            value: query,\n            onChange: e => {\n              setQuery(e.target.value);\n              menu.onOpen();\n            },\n            onKeyDown: onKeyDown\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Center, {\n            pos: \"absolute\",\n            left: \"0\",\n            w: \"40px\",\n            h: \"40px\",\n            children: /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n          maxH: \"calc(60vh - 40px)\",\n          p: \"0\",\n          ref: menuRef,\n          children: open && /*#__PURE__*/_jsxDEV(Box, {\n            as: \"ul\",\n            borderTopWidth: \"1px\",\n            role: \"listbox\",\n            id: \"docsearch-menu\",\n            bg: useColorModeValue(\"white\", \"gray.700\"),\n            children: results.map((item, index) => {\n              const selected = index === active;\n              const isLvl1 = item.type === \"lvl1\";\n              return /*#__PURE__*/_jsxDEV(Link, {\n                href: item.url,\n                children: /*#__PURE__*/_jsxDEV(Box, {\n                  id: `search-item-${index}`,\n                  as: \"li\",\n                  cursor: \"pointer\",\n                  onMouseEnter: () => {\n                    setActive(index);\n                    eventRef.current = \"mouse\";\n                  },\n                  ref: menuNodes.ref(index),\n                  role: \"option\",\n                  \"aria-selected\": selected ? true : undefined,\n                  _selected: {\n                    bg: \"teal.500\",\n                    color: \"white\",\n                    //@ts-expect-error fix this in chakra styled-system types. I should be able to pass other css styles\n                    mark: {\n                      color: \"white\",\n                      textDecor: \"underline\"\n                    }\n                  },\n                  fontSize: \"sm\",\n                  px: \"4\",\n                  py: \"2\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  minH: \"60px\",\n                  children: [isLvl1 ? /*#__PURE__*/_jsxDEV(DocIcon, {\n                    opacity: 0.3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 295,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(HashIcon, {\n                    opacity: 0.3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 297,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(Box, {\n                    flex: \"1\",\n                    ml: \"3\",\n                    children: [!isLvl1 && /*#__PURE__*/_jsxDEV(Box, {\n                      fontWeight: \"medium\",\n                      fontSize: \"xs\",\n                      opacity: 0.6,\n                      children: item.hierarchy.lvl1\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 302,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(Box, {\n                      mb: \"1\",\n                      fontWeight: \"semibold\",\n                      children: /*#__PURE__*/_jsxDEV(OptionText, {\n                        searchWords: [query],\n                        textToHighlight: item.content\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 311,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 310,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 300,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(EnterIcon, {\n                    opacity: 0.3\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 318,\n                    columnNumber: 25\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 23\n                }, this)\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\nexport default OmniSearch;","map":{"version":3,"sources":["/Users/sunfei/Downloads/website/src/components/omni-search.tsx"],"names":["SearchIcon","Box","Center","chakra","Flex","Modal","ModalBody","ModalContent","ModalOverlay","useColorModeValue","useDisclosure","useEventListener","useUpdateEffect","searchData","matchSorter","Link","useRouter","React","MultiRef","scrollIntoView","findAll","SearchButton","OptionText","props","searchWords","textToHighlight","chunks","highlightedText","map","chunk","end","highlight","start","text","substr","DocIcon","EnterIcon","HashIcon","OmniSearch","router","query","setQuery","useState","active","setActive","menu","modal","menuNodes","menuRef","useRef","eventRef","useEffect","events","on","onClose","off","event","isMac","test","navigator","platform","hotkey","key","toLowerCase","preventDefault","onOpen","isOpen","length","results","useMemo","getResults","keys","slice","sort","a","b","hierarchy","lvl2","onKeyDown","useCallback","e","current","push","url","node","get","scrollMode","block","inline","boundary","open","target","value","item","index","selected","isLvl1","type","ref","undefined","bg","color","mark","textDecor","lvl1","content","id"],"mappings":"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","sourcesContent":["import { SearchIcon } from \"@chakra-ui/icons\"\nimport {\n  Box,\n  Center,\n  chakra,\n  Flex,\n  Modal,\n  ModalBody,\n  ModalContent,\n  ModalOverlay,\n  useColorModeValue,\n  useDisclosure,\n  useEventListener,\n  useUpdateEffect,\n} from \"@chakra-ui/react\"\nimport searchData from \"configs/search-meta.json\"\nimport { matchSorter } from \"match-sorter\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/router\"\nimport * as React from \"react\"\nimport MultiRef from \"react-multi-ref\"\nimport scrollIntoView from \"scroll-into-view-if-needed\"\nimport { findAll } from \"highlight-words-core\"\nimport { SearchButton } from \"./algolia-search\"\n\nfunction OptionText(props: any) {\n  const { searchWords, textToHighlight } = props\n\n  const chunks = findAll({\n    searchWords,\n    textToHighlight,\n  })\n\n  const highlightedText = chunks.map((chunk) => {\n    const { end, highlight, start } = chunk\n    const text = textToHighlight.substr(start, end - start)\n    if (highlight) {\n      return (\n        <Box as=\"mark\" color=\"teal.500\" bg=\"transparent\" fontWeight=\"medium\">\n          {text}\n        </Box>\n      )\n    } else {\n      return text\n    }\n  })\n\n  return highlightedText\n}\n\nfunction DocIcon(props) {\n  return (\n    <chakra.svg\n      strokeWidth=\"2px\"\n      width=\"20px\"\n      height=\"20px\"\n      viewBox=\"0 0 20 20\"\n      {...props}\n    >\n      <path\n        d=\"M17 6v12c0 .52-.2 1-1 1H4c-.7 0-1-.33-1-1V2c0-.55.42-1 1-1h8l5 5zM14 8h-3.13c-.51 0-.87-.34-.87-.87V4\"\n        stroke=\"currentColor\"\n        fill=\"none\"\n        fillRule=\"evenodd\"\n        strokeLinejoin=\"round\"\n      />\n    </chakra.svg>\n  )\n}\n\nfunction EnterIcon(props) {\n  return (\n    <chakra.svg\n      strokeWidth=\"2px\"\n      width=\"16px\"\n      height=\"16px\"\n      viewBox=\"0 0 20 20\"\n      {...props}\n    >\n      <g\n        stroke=\"currentColor\"\n        fill=\"none\"\n        fillRule=\"evenodd\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      >\n        <path d=\"M18 3v4c0 2-2 4-4 4H2\" />\n        <path d=\"M8 17l-6-6 6-6\" />\n      </g>\n    </chakra.svg>\n  )\n}\n\nfunction HashIcon(props) {\n  return (\n    <chakra.svg\n      strokeWidth=\"2px\"\n      width=\"20px\"\n      height=\"20px\"\n      viewBox=\"0 0 20 20\"\n      {...props}\n    >\n      <path\n        d=\"M13 13h4-4V8H7v5h6v4-4H7V8H3h4V3v5h6V3v5h4-4v5zm-6 0v4-4H3h4z\"\n        stroke=\"currentColor\"\n        fill=\"none\"\n        fillRule=\"evenodd\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </chakra.svg>\n  )\n}\n\nfunction OmniSearch() {\n  const router = useRouter()\n  const [query, setQuery] = React.useState(\"\")\n  const [active, setActive] = React.useState(0)\n  const menu = useDisclosure()\n  const modal = useDisclosure()\n  const [menuNodes] = React.useState(() => new MultiRef<number, HTMLElement>())\n  const menuRef = React.useRef<HTMLDivElement>(null)\n  const eventRef = React.useRef<\"mouse\" | \"keyboard\">(null)\n\n  React.useEffect(() => {\n    router.events.on(\"routeChangeComplete\", modal.onClose)\n    return () => {\n      router.events.off(\"routeChangeComplete\", modal.onClose)\n    }\n  }, [])\n\n  useEventListener(\"keydown\", (event) => {\n    const isMac = /(Mac|iPhone|iPod|iPad)/i.test(navigator?.platform)\n    const hotkey = isMac ? \"metaKey\" : \"ctrlKey\"\n    if (event?.key?.toLowerCase() === \"k\" && event[hotkey]) {\n      event.preventDefault()\n      modal.onOpen()\n    }\n  })\n\n  React.useEffect(() => {\n    if (modal.isOpen && query.length > 0) {\n      setQuery(\"\")\n    }\n  }, [modal.isOpen])\n\n  const results = React.useMemo(\n    function getResults() {\n      if (query.length < 2) return []\n      return matchSorter(searchData, query, {\n        keys: [\"content\", \"hierarchy.lvl1\", \"hierarchy.lvl2\", \"hierarchy.lvl3\"],\n      })\n        .slice(0, 20)\n        .sort((a, b) => {\n          if (a.hierarchy.lvl2 == null && b.hierarchy != null) return -1\n          if (a.hierarchy.lvl2 != null && b.hierarchy == null) return 1\n          return 0\n        })\n    },\n    [query],\n  )\n\n  const onKeyDown = React.useCallback(\n    (e: React.KeyboardEvent) => {\n      eventRef.current = \"keyboard\"\n      switch (e.key) {\n        case \"ArrowDown\": {\n          e.preventDefault()\n          if (active + 1 < results.length) {\n            setActive(active + 1)\n          }\n          break\n        }\n        case \"ArrowUp\": {\n          e.preventDefault()\n          if (active - 1 >= 0) {\n            setActive(active - 1)\n          }\n          break\n        }\n        case \"Enter\": {\n          router.push(results[active].url)\n          break\n        }\n      }\n    },\n    [active, results, router],\n  )\n\n  useUpdateEffect(() => {\n    setActive(0)\n  }, [query])\n\n  useUpdateEffect(() => {\n    if (!menuRef.current || eventRef.current === \"mouse\") return\n    const node = menuNodes.map.get(active)\n    if (!node) return\n    scrollIntoView(node, {\n      scrollMode: \"if-needed\",\n      block: \"nearest\",\n      inline: \"nearest\",\n      boundary: menuRef.current,\n    })\n  }, [active])\n\n  const open = menu.isOpen && results.length > 0\n\n  return (\n    <>\n      <SearchButton onClick={modal.onOpen} />\n      <Modal\n        scrollBehavior=\"inside\"\n        isOpen={modal.isOpen}\n        onClose={modal.onClose}\n      >\n        <ModalOverlay />\n        <ModalContent\n          role=\"combobox\"\n          aria-expanded=\"true\"\n          aria-haspopup=\"listbox\"\n          rounded=\"md\"\n          overflow=\"hidden\"\n          top=\"10vh\"\n          bg=\"transparent\"\n          shadow=\"search\"\n        >\n          <Flex pos=\"relative\" align=\"stretch\">\n            <chakra.input\n              aria-autocomplete=\"list\"\n              autoComplete=\"off\"\n              autoCorrect=\"off\"\n              spellCheck=\"false\"\n              maxLength={64}\n              w=\"100%\"\n              h=\"40px\"\n              bg={useColorModeValue(\"white\", \"gray.700\")}\n              pl=\"40px\"\n              outline=\"0\"\n              id=\"docsearch-input\"\n              placeholder=\"Search the docs\"\n              value={query}\n              onChange={(e) => {\n                setQuery(e.target.value)\n                menu.onOpen()\n              }}\n              onKeyDown={onKeyDown}\n            />\n            <Center pos=\"absolute\" left=\"0\" w=\"40px\" h=\"40px\">\n              <SearchIcon />\n            </Center>\n          </Flex>\n          <ModalBody maxH=\"calc(60vh - 40px)\" p=\"0\" ref={menuRef}>\n            {open && (\n              <Box\n                as=\"ul\"\n                borderTopWidth=\"1px\"\n                role=\"listbox\"\n                id=\"docsearch-menu\"\n                bg={useColorModeValue(\"white\", \"gray.700\")}\n              >\n                {results.map((item, index) => {\n                  const selected = index === active\n                  const isLvl1 = item.type === \"lvl1\"\n                  return (\n                    <Link key={item.id} href={item.url}>\n                      <Box\n                        id={`search-item-${index}`}\n                        as=\"li\"\n                        cursor=\"pointer\"\n                        onMouseEnter={() => {\n                          setActive(index)\n                          eventRef.current = \"mouse\"\n                        }}\n                        ref={menuNodes.ref(index)}\n                        role=\"option\"\n                        aria-selected={selected ? true : undefined}\n                        _selected={{\n                          bg: \"teal.500\",\n                          color: \"white\",\n                          //@ts-expect-error fix this in chakra styled-system types. I should be able to pass other css styles\n                          mark: {\n                            color: \"white\",\n                            textDecor: \"underline\",\n                          },\n                        }}\n                        key={item.id}\n                        fontSize=\"sm\"\n                        px=\"4\"\n                        py=\"2\"\n                        display=\"flex\"\n                        alignItems=\"center\"\n                        minH=\"60px\"\n                      >\n                        {isLvl1 ? (\n                          <DocIcon opacity={0.3} />\n                        ) : (\n                          <HashIcon opacity={0.3} />\n                        )}\n\n                        <Box flex=\"1\" ml=\"3\">\n                          {!isLvl1 && (\n                            <Box\n                              fontWeight=\"medium\"\n                              fontSize=\"xs\"\n                              opacity={0.6}\n                            >\n                              {item.hierarchy.lvl1}\n                            </Box>\n                          )}\n                          <Box mb=\"1\" fontWeight=\"semibold\">\n                            <OptionText\n                              searchWords={[query]}\n                              textToHighlight={item.content}\n                            />\n                          </Box>\n                        </Box>\n\n                        <EnterIcon opacity={0.3} />\n                      </Box>\n                    </Link>\n                  )\n                })}\n              </Box>\n            )}\n          </ModalBody>\n        </ModalContent>\n      </Modal>\n    </>\n  )\n}\n\nexport default OmniSearch\n"]},"metadata":{},"sourceType":"module"}